<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Bivariate Linear Regression | Lab Guide to Quantitative Research Methods in Political Science, Public Policy &amp; Public Administration.</title>
  <meta name="description" content="8 Bivariate Linear Regression | Lab Guide to Quantitative Research Methods in Political Science, Public Policy &amp; Public Administration." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Bivariate Linear Regression | Lab Guide to Quantitative Research Methods in Political Science, Public Policy &amp; Public Administration." />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Bivariate Linear Regression | Lab Guide to Quantitative Research Methods in Political Science, Public Policy &amp; Public Administration." />
  
  
  

<meta name="author" content="Joseph Ripberger, Cody Adams, Alex Davis, and Josie Davis" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="covariance-and-correlation.html">
<link rel="next" href="multivariable-linear-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-rstudio-and-r-markdown.html"><a href="introduction-to-r-rstudio-and-r-markdown.html"><i class="fa fa-check"></i><b>1</b> Introduction to R, RStudio, and R Markdown</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-rstudio-and-r-markdown.html"><a href="introduction-to-r-rstudio-and-r-markdown.html#introduction-to-r-the-language"><i class="fa fa-check"></i><b>1.1</b> Introduction to R, the language</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r-rstudio-and-r-markdown.html"><a href="introduction-to-r-rstudio-and-r-markdown.html#benefits-of-r"><i class="fa fa-check"></i><b>1.1.1</b> Benefits of R</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r-rstudio-and-r-markdown.html"><a href="introduction-to-r-rstudio-and-r-markdown.html#packages"><i class="fa fa-check"></i><b>1.1.2</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-rstudio-and-r-markdown.html"><a href="introduction-to-r-rstudio-and-r-markdown.html#rsudio"><i class="fa fa-check"></i><b>1.2</b> RSudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-r-rstudio-and-r-markdown.html"><a href="introduction-to-r-rstudio-and-r-markdown.html#navigating-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Navigating RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-rstudio-and-r-markdown.html"><a href="introduction-to-r-rstudio-and-r-markdown.html#r-markdown"><i class="fa fa-check"></i><b>1.3</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-of-r.html"><a href="basics-of-r.html"><i class="fa fa-check"></i><b>2</b> Basics of R</a><ul>
<li class="chapter" data-level="2.1" data-path="basics-of-r.html"><a href="basics-of-r.html#r-as-a-calculator"><i class="fa fa-check"></i><b>2.1</b> R, as a Calculator</a><ul>
<li class="chapter" data-level="2.1.1" data-path="basics-of-r.html"><a href="basics-of-r.html#order-of-operations"><i class="fa fa-check"></i><b>2.1.1</b> Order of Operations</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basics-of-r.html"><a href="basics-of-r.html#objects"><i class="fa fa-check"></i><b>2.2</b> Objects</a></li>
<li class="chapter" data-level="2.3" data-path="basics-of-r.html"><a href="basics-of-r.html#functions"><i class="fa fa-check"></i><b>2.3</b> Functions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="basics-of-r.html"><a href="basics-of-r.html#object-types"><i class="fa fa-check"></i><b>2.3.1</b> Object Types</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basics-of-r.html"><a href="basics-of-r.html#packages-1"><i class="fa fa-check"></i><b>2.4</b> Packages</a><ul>
<li class="chapter" data-level="2.4.1" data-path="basics-of-r.html"><a href="basics-of-r.html#installing-packages"><i class="fa fa-check"></i><b>2.4.1</b> Installing Packages</a></li>
<li class="chapter" data-level="2.4.2" data-path="basics-of-r.html"><a href="basics-of-r.html#loading-packages"><i class="fa fa-check"></i><b>2.4.2</b> Loading Packages</a></li>
<li class="chapter" data-level="2.4.3" data-path="basics-of-r.html"><a href="basics-of-r.html#updating-packages"><i class="fa fa-check"></i><b>2.4.3</b> Updating Packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="basics-of-r.html"><a href="basics-of-r.html#r-help"><i class="fa fa-check"></i><b>2.5</b> R Help</a></li>
<li class="chapter" data-level="2.6" data-path="basics-of-r.html"><a href="basics-of-r.html#setting-a-working-directory"><i class="fa fa-check"></i><b>2.6</b> Setting a Working Directory</a></li>
<li class="chapter" data-level="2.7" data-path="basics-of-r.html"><a href="basics-of-r.html#importing-your-data"><i class="fa fa-check"></i><b>2.7</b> Importing Your Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html"><i class="fa fa-check"></i><b>3</b> Formatting, Describing, and Visualizing Data</a><ul>
<li class="chapter" data-level="3.1" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#factoring"><i class="fa fa-check"></i><b>3.1</b> Factoring</a><ul>
<li class="chapter" data-level="3.1.1" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#coerce-factoring"><i class="fa fa-check"></i><b>3.1.1</b> Coerce Factoring</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#recoding"><i class="fa fa-check"></i><b>3.2</b> Recoding</a><ul>
<li class="chapter" data-level="3.2.1" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#factoring-and-recoding"><i class="fa fa-check"></i><b>3.2.1</b> Factoring and Recoding</a></li>
<li class="chapter" data-level="3.2.2" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#creating-a-dummy-variable"><i class="fa fa-check"></i><b>3.2.2</b> Creating a Dummy Variable</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#part-iii-building-and-sorting-your-data"><i class="fa fa-check"></i><b>3.3</b> Part III: Building and Sorting Your Data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#the-tidyverse"><i class="fa fa-check"></i><b>3.3.1</b> The Tidyverse</a></li>
<li class="chapter" data-level="3.3.2" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#other-methods-of-exploring-your-data"><i class="fa fa-check"></i><b>3.3.2</b> Other Methods of Exploring Your Data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#working-with-nominal-data"><i class="fa fa-check"></i><b>3.4</b> Working with Nominal Data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#finding-the-mode"><i class="fa fa-check"></i><b>3.4.1</b> Finding the Mode</a></li>
<li class="chapter" data-level="3.4.2" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#visualizing-nominal-data"><i class="fa fa-check"></i><b>3.4.2</b> Visualizing Nominal Data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#working-with-ordinal-data"><i class="fa fa-check"></i><b>3.5</b> Working with Ordinal Data</a></li>
<li class="chapter" data-level="3.6" data-path="formatting-describing-and-visualizing-data.html"><a href="formatting-describing-and-visualizing-data.html#working-with-interval-data"><i class="fa fa-check"></i><b>3.6</b> Working with Interval Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualizing-data-probability-the-normal-distribution-and-z-scores.html"><a href="visualizing-data-probability-the-normal-distribution-and-z-scores.html"><i class="fa fa-check"></i><b>4</b> Visualizing Data, Probability, the Normal Distribution, and Z Scores</a><ul>
<li class="chapter" data-level="4.1" data-path="visualizing-data-probability-the-normal-distribution-and-z-scores.html"><a href="visualizing-data-probability-the-normal-distribution-and-z-scores.html#histograms-and-density"><i class="fa fa-check"></i><b>4.1</b> Histograms and Density</a><ul>
<li class="chapter" data-level="4.1.1" data-path="visualizing-data-probability-the-normal-distribution-and-z-scores.html"><a href="visualizing-data-probability-the-normal-distribution-and-z-scores.html#normal-distribution-and-histograms"><i class="fa fa-check"></i><b>4.1.1</b> Normal Distribution and Histograms</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="visualizing-data-probability-the-normal-distribution-and-z-scores.html"><a href="visualizing-data-probability-the-normal-distribution-and-z-scores.html#probability-and-distributions"><i class="fa fa-check"></i><b>4.2</b> Probability and Distributions</a></li>
<li class="chapter" data-level="4.3" data-path="visualizing-data-probability-the-normal-distribution-and-z-scores.html"><a href="visualizing-data-probability-the-normal-distribution-and-z-scores.html#visualizing-normality"><i class="fa fa-check"></i><b>4.3</b> Visualizing Normality</a></li>
<li class="chapter" data-level="4.4" data-path="visualizing-data-probability-the-normal-distribution-and-z-scores.html"><a href="visualizing-data-probability-the-normal-distribution-and-z-scores.html#z-scores"><i class="fa fa-check"></i><b>4.4</b> Z-Scores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="foundations-for-inference.html"><a href="foundations-for-inference.html"><i class="fa fa-check"></i><b>5</b> Foundations for Inference</a><ul>
<li class="chapter" data-level="5.1" data-path="foundations-for-inference.html"><a href="foundations-for-inference.html#testing-for-normality"><i class="fa fa-check"></i><b>5.1</b> Testing for Normality</a><ul>
<li class="chapter" data-level="5.1.1" data-path="foundations-for-inference.html"><a href="foundations-for-inference.html#shapiro-wilk-test"><i class="fa fa-check"></i><b>5.1.1</b> Shapiro-Wilk Test</a></li>
<li class="chapter" data-level="5.1.2" data-path="foundations-for-inference.html"><a href="foundations-for-inference.html#testing-normality"><i class="fa fa-check"></i><b>5.1.2</b> Testing Normality</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="foundations-for-inference.html"><a href="foundations-for-inference.html#standard-errors"><i class="fa fa-check"></i><b>5.2</b> Standard Errors</a></li>
<li class="chapter" data-level="5.3" data-path="foundations-for-inference.html"><a href="foundations-for-inference.html#confidence-intervals"><i class="fa fa-check"></i><b>5.3</b> Confidence Intervals</a></li>
<li class="chapter" data-level="5.4" data-path="foundations-for-inference.html"><a href="foundations-for-inference.html#more-on-single-sample-t-tests"><i class="fa fa-check"></i><b>5.4</b> More on Single Sample T-tests</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html"><i class="fa fa-check"></i><b>6</b> Inference for Two Populations</a><ul>
<li class="chapter" data-level="6.1" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html#proportions"><i class="fa fa-check"></i><b>6.1</b> Proportions</a><ul>
<li class="chapter" data-level="6.1.1" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html#two-populations"><i class="fa fa-check"></i><b>6.1.1</b> Two Populations</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html#cross-tabulations"><i class="fa fa-check"></i><b>6.2</b> Cross Tabulations</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html#other-coefficients"><i class="fa fa-check"></i><b>6.2.1</b> Other Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html#independent-t-tests"><i class="fa fa-check"></i><b>6.3</b> Independent t-tests</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html#other-independent-sample-tests"><i class="fa fa-check"></i><b>6.3.1</b> Other Independent Sample Tests</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html#paired-t-test"><i class="fa fa-check"></i><b>6.4</b> Paired t-test</a></li>
<li class="chapter" data-level="6.5" data-path="inference-for-two-populations.html"><a href="inference-for-two-populations.html#visualizing-differences-in-means"><i class="fa fa-check"></i><b>6.5</b> Visualizing Differences in Means</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html"><i class="fa fa-check"></i><b>7</b> Covariance and Correlation</a><ul>
<li class="chapter" data-level="7.1" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#covariance"><i class="fa fa-check"></i><b>7.1</b> Covariance</a><ul>
<li class="chapter" data-level="7.1.1" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#covariance-by-hand"><i class="fa fa-check"></i><b>7.1.1</b> Covariance by Hand</a></li>
<li class="chapter" data-level="7.1.2" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#covariance-in-r"><i class="fa fa-check"></i><b>7.1.2</b> Covariance in R</a></li>
<li class="chapter" data-level="7.1.3" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#covariance-in-class-data-set"><i class="fa fa-check"></i><b>7.1.3</b> Covariance in Class Data Set</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#correlation"><i class="fa fa-check"></i><b>7.2</b> Correlation</a><ul>
<li class="chapter" data-level="7.2.1" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#correlation-by-hand"><i class="fa fa-check"></i><b>7.2.1</b> Correlation by Hand</a></li>
<li class="chapter" data-level="7.2.2" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#correlation-tests"><i class="fa fa-check"></i><b>7.2.2</b> Correlation Tests</a></li>
<li class="chapter" data-level="7.2.3" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#correlation-across-groups"><i class="fa fa-check"></i><b>7.2.3</b> Correlation Across Groups</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#visualizing-correlation"><i class="fa fa-check"></i><b>7.3</b> Visualizing Correlation</a><ul>
<li class="chapter" data-level="7.3.1" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#another-example-political-party"><i class="fa fa-check"></i><b>7.3.1</b> Another Example: Political Party</a></li>
<li class="chapter" data-level="7.3.2" data-path="covariance-and-correlation.html"><a href="covariance-and-correlation.html#one-more-visualization"><i class="fa fa-check"></i><b>7.3.2</b> One More Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Bivariate Linear Regression</a><ul>
<li class="chapter" data-level="8.1" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html#bivariate-linear-regression-by-hand"><i class="fa fa-check"></i><b>8.1</b> Bivariate Linear Regression by Hand</a><ul>
<li class="chapter" data-level="8.1.1" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html#calculating-goodness-of-fit"><i class="fa fa-check"></i><b>8.1.1</b> Calculating Goodness of Fit</a></li>
<li class="chapter" data-level="8.1.2" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html#checking-our-work"><i class="fa fa-check"></i><b>8.1.2</b> Checking Our Work</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html#bivariate-regression-in-r"><i class="fa fa-check"></i><b>8.2</b> Bivariate Regression in R</a></li>
<li class="chapter" data-level="8.3" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html#the-residuals"><i class="fa fa-check"></i><b>8.3</b> The Residuals</a></li>
<li class="chapter" data-level="8.4" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html#comparing-models"><i class="fa fa-check"></i><b>8.4</b> Comparing Models</a><ul>
<li class="chapter" data-level="8.4.1" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html#visualizing-multiple-models"><i class="fa fa-check"></i><b>8.4.1</b> Visualizing Multiple Models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="bivariate-linear-regression.html"><a href="bivariate-linear-regression.html#hypothesis-testing"><i class="fa fa-check"></i><b>8.5</b> Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html"><i class="fa fa-check"></i><b>9</b> Multivariable Linear Regression</a><ul>
<li class="chapter" data-level="9.1" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html#calculating-least-squared-estimates"><i class="fa fa-check"></i><b>9.1</b> Calculating Least-Squared Estimates</a><ul>
<li class="chapter" data-level="9.1.1" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html#matrix-algebra"><i class="fa fa-check"></i><b>9.1.1</b> Matrix Algebra</a></li>
<li class="chapter" data-level="9.1.2" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html#representing-system-of-linear-equations-as-matrices"><i class="fa fa-check"></i><b>9.1.2</b> Representing System of Linear Equations as Matrices</a></li>
<li class="chapter" data-level="9.1.3" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html#ols-regression-and-matrices"><i class="fa fa-check"></i><b>9.1.3</b> OLS Regression and Matrices</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html#multiple-regression-in-r"><i class="fa fa-check"></i><b>9.2</b> Multiple Regression in R</a></li>
<li class="chapter" data-level="9.3" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html#hypothesis-testing-with-multivariable-regression"><i class="fa fa-check"></i><b>9.3</b> Hypothesis Testing with Multivariable Regression</a><ul>
<li class="chapter" data-level="9.3.1" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html#visualizing-multivariable-linear-regression"><i class="fa fa-check"></i><b>9.3.1</b> Visualizing Multivariable Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="multivariable-linear-regression.html"><a href="multivariable-linear-regression.html#predicting-with-ols-regression"><i class="fa fa-check"></i><b>9.4</b> Predicting with OLS Regression</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="categorical-explanatory-variables-dummy-variables-and-interactions.html"><a href="categorical-explanatory-variables-dummy-variables-and-interactions.html"><i class="fa fa-check"></i><b>10</b> Categorical Explanatory Variables, Dummy Variables, and Interactions</a><ul>
<li class="chapter" data-level="10.1" data-path="categorical-explanatory-variables-dummy-variables-and-interactions.html"><a href="categorical-explanatory-variables-dummy-variables-and-interactions.html#dummy-variables"><i class="fa fa-check"></i><b>10.1</b> Dummy Variables</a><ul>
<li class="chapter" data-level="10.1.1" data-path="categorical-explanatory-variables-dummy-variables-and-interactions.html"><a href="categorical-explanatory-variables-dummy-variables-and-interactions.html#multiple-dummy-variables"><i class="fa fa-check"></i><b>10.1.1</b> Multiple Dummy Variables</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="categorical-explanatory-variables-dummy-variables-and-interactions.html"><a href="categorical-explanatory-variables-dummy-variables-and-interactions.html#interactions"><i class="fa fa-check"></i><b>10.2</b> Interactions</a><ul>
<li class="chapter" data-level="10.2.1" data-path="categorical-explanatory-variables-dummy-variables-and-interactions.html"><a href="categorical-explanatory-variables-dummy-variables-and-interactions.html#interactions-with-two-non-binary-variables"><i class="fa fa-check"></i><b>10.2.1</b> Interactions with Two Non-binary Variables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="categorical-explanatory-variables-dummy-variables-and-interactions.html"><a href="categorical-explanatory-variables-dummy-variables-and-interactions.html#releveling-variables"><i class="fa fa-check"></i><b>10.3</b> Releveling Variables</a></li>
<li class="chapter" data-level="10.4" data-path="categorical-explanatory-variables-dummy-variables-and-interactions.html"><a href="categorical-explanatory-variables-dummy-variables-and-interactions.html#interaction-plots"><i class="fa fa-check"></i><b>10.4</b> Interaction Plots</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="non-linearity-non-normality-and-multicollinearity.html"><a href="non-linearity-non-normality-and-multicollinearity.html"><i class="fa fa-check"></i><b>11</b> Non-linearity, Non-normality, and Multicollinearity</a><ul>
<li class="chapter" data-level="11.1" data-path="non-linearity-non-normality-and-multicollinearity.html"><a href="non-linearity-non-normality-and-multicollinearity.html#non-linearity"><i class="fa fa-check"></i><b>11.1</b> Non-linearity</a><ul>
<li class="chapter" data-level="11.1.1" data-path="non-linearity-non-normality-and-multicollinearity.html"><a href="non-linearity-non-normality-and-multicollinearity.html#exploring-non-linearity"><i class="fa fa-check"></i><b>11.1.1</b> Exploring Non-linearity</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="non-linearity-non-normality-and-multicollinearity.html"><a href="non-linearity-non-normality-and-multicollinearity.html#non-normality"><i class="fa fa-check"></i><b>11.2</b> Non-normality</a></li>
<li class="chapter" data-level="11.3" data-path="non-linearity-non-normality-and-multicollinearity.html"><a href="non-linearity-non-normality-and-multicollinearity.html#multicollinearity"><i class="fa fa-check"></i><b>11.3</b> Multicollinearity</a></li>
<li class="chapter" data-level="11.4" data-path="non-linearity-non-normality-and-multicollinearity.html"><a href="non-linearity-non-normality-and-multicollinearity.html#standardizing-coefficients"><i class="fa fa-check"></i><b>11.4</b> Standardizing Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="diagnosing-and-addressing-problems-in-linear-regression.html"><a href="diagnosing-and-addressing-problems-in-linear-regression.html"><i class="fa fa-check"></i><b>12</b> Diagnosing and Addressing Problems in Linear Regression</a><ul>
<li class="chapter" data-level="12.1" data-path="diagnosing-and-addressing-problems-in-linear-regression.html"><a href="diagnosing-and-addressing-problems-in-linear-regression.html#introduction-to-the-data"><i class="fa fa-check"></i><b>12.1</b> Introduction to the Data</a></li>
<li class="chapter" data-level="12.2" data-path="diagnosing-and-addressing-problems-in-linear-regression.html"><a href="diagnosing-and-addressing-problems-in-linear-regression.html#outliers"><i class="fa fa-check"></i><b>12.2</b> Outliers</a></li>
<li class="chapter" data-level="12.3" data-path="diagnosing-and-addressing-problems-in-linear-regression.html"><a href="diagnosing-and-addressing-problems-in-linear-regression.html#heteroscedasticity"><i class="fa fa-check"></i><b>12.3</b> Heteroscedasticity</a></li>
<li class="chapter" data-level="12.4" data-path="diagnosing-and-addressing-problems-in-linear-regression.html"><a href="diagnosing-and-addressing-problems-in-linear-regression.html#revisiting-linearity"><i class="fa fa-check"></i><b>12.4</b> Revisiting Linearity</a><ul>
<li class="chapter" data-level="12.4.1" data-path="diagnosing-and-addressing-problems-in-linear-regression.html"><a href="diagnosing-and-addressing-problems-in-linear-regression.html#normality"><i class="fa fa-check"></i><b>12.4.1</b> Normality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>13</b> Logistic Regression</a><ul>
<li class="chapter" data-level="13.1" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-with-a-binary-dv"><i class="fa fa-check"></i><b>13.1</b> Logistic Regression with a Binary DV</a><ul>
<li class="chapter" data-level="13.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#goodness-of-fit-logit-regression"><i class="fa fa-check"></i><b>13.1.1</b> Goodness of Fit, Logit Regression</a></li>
<li class="chapter" data-level="13.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#percent-correctly-predicted"><i class="fa fa-check"></i><b>13.1.2</b> Percent Correctly Predicted</a></li>
<li class="chapter" data-level="13.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#logit-regression-with-groups"><i class="fa fa-check"></i><b>13.1.3</b> Logit Regression with Groups</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="logistic-regression.html"><a href="logistic-regression.html#ordered-logit-and-creating-an-index"><i class="fa fa-check"></i><b>13.2</b> Ordered Logit and Creating an Index</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="statistical-simulations.html"><a href="statistical-simulations.html"><i class="fa fa-check"></i><b>14</b> Statistical Simulations</a><ul>
<li class="chapter" data-level="14.1" data-path="statistical-simulations.html"><a href="statistical-simulations.html#the-basics"><i class="fa fa-check"></i><b>14.1</b> The Basics</a><ul>
<li class="chapter" data-level="14.1.1" data-path="statistical-simulations.html"><a href="statistical-simulations.html#plotting-predictions-with-zelig"><i class="fa fa-check"></i><b>14.1.1</b> Plotting Predictions with Zelig</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="statistical-simulations.html"><a href="statistical-simulations.html#other-models"><i class="fa fa-check"></i><b>14.2</b> Other Models</a><ul>
<li class="chapter" data-level="14.2.1" data-path="statistical-simulations.html"><a href="statistical-simulations.html#ordered-logit"><i class="fa fa-check"></i><b>14.2.1</b> Ordered Logit</a></li>
<li class="chapter" data-level="14.2.2" data-path="statistical-simulations.html"><a href="statistical-simulations.html#another-example"><i class="fa fa-check"></i><b>14.2.2</b> Another Example</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="statistical-simulations.html"><a href="statistical-simulations.html#zelig-with-non-zelig-models"><i class="fa fa-check"></i><b>14.3</b> Zelig with non-Zelig Models:</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html"><i class="fa fa-check"></i><b>15</b> Appendix: Guide to Data Visualization</a><ul>
<li class="chapter" data-level="15.1" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#deciding-which-visualization-to-use"><i class="fa fa-check"></i><b>15.1</b> Deciding Which Visualization to Use</a><ul>
<li class="chapter" data-level="" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#for-exploring-a-single-variable"><i class="fa fa-check"></i>For Exploring a Single Variable</a></li>
<li class="chapter" data-level="" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#for-displaying-two-or-more-variables"><i class="fa fa-check"></i>For Displaying Two (or more) Variables</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#adding-labels"><i class="fa fa-check"></i><b>15.2</b> Adding Labels</a></li>
<li class="chapter" data-level="15.3" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#scale-and-limits"><i class="fa fa-check"></i><b>15.3</b> Scale and Limits</a></li>
<li class="chapter" data-level="15.4" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#visualizing-error"><i class="fa fa-check"></i><b>15.4</b> Visualizing Error</a><ul>
<li class="chapter" data-level="" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#confidence-intervals-1"><i class="fa fa-check"></i>Confidence Intervals</a></li>
<li class="chapter" data-level="" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#error-bars"><i class="fa fa-check"></i>Error Bars</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#adding-color"><i class="fa fa-check"></i><b>15.5</b> Adding Color</a></li>
<li class="chapter" data-level="15.6" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#position-adjustments"><i class="fa fa-check"></i><b>15.6</b> Position Adjustments</a></li>
<li class="chapter" data-level="15.7" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#using-themes"><i class="fa fa-check"></i><b>15.7</b> Using Themes</a></li>
<li class="chapter" data-level="15.8" data-path="appendix-guide-to-data-visualization.html"><a href="appendix-guide-to-data-visualization.html#putting-it-all-together"><i class="fa fa-check"></i><b>15.8</b> Putting it All Together</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lab Guide to Quantitative Research Methods in Political Science, Public Policy &amp; Public Administration.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bivariate-linear-regression" class="section level1">
<h1><span class="header-section-number">8</span> Bivariate Linear Regression</h1>
<p>This lab will cover the basics of bivariate linear regression, introducing via manual calculations and R functions. The following packages are required for this lab:</p>
<ol style="list-style-type: decimal">
<li>tidyverse</li>
<li>psych</li>
<li>car</li>
<li>memisc</li>
<li>stargazer</li>
<li>reshape2</li>
</ol>
<div id="bivariate-linear-regression-by-hand" class="section level2">
<h2><span class="header-section-number">8.1</span> Bivariate Linear Regression by Hand</h2>
<p>The goal of bivariate linear regression is to estimate a line (slope and intercept) that minimizes the error term (residual). The bivariate linear regression model is as follows:</p>
<p><span class="math display">\[y_i=\alpha+\beta x_i+\varepsilon_i\]</span></p>
<p>Where, <code>y</code> is the dependent variable, <code>i</code> is the unit of analysis, <span class="math inline">\(\alpha\)</span> is the y-intercept, <span class="math inline">\(\beta\)</span> is the slope, <code>x</code> is the independent variable, and <span class="math inline">\(\varepsilon\)</span> is the error term (residuals).</p>
<p>When working with samples, we develop an estimated model:</p>
<p><span class="math display">\[\hat{y}=\hat{\alpha}+\hat{\beta} x\]</span></p>
<p>Where, the hat implies the coefficients are estimates from data.</p>
<p>This lab focuses on the ordinary least squares method to find <span class="math inline">\(\hat{\alpha}\)</span> and <span class="math inline">\(\hat{\beta}\)</span> such that if given a value of <code>x</code> you can return an estimate of y (<span class="math inline">\(\hat{y}\)</span>).</p>
<p>To demonstrate, we will explore the relationship between ideology and concern for natural resources. The first step is to subset the variables of interest absent of NA values:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb393-1" data-line-number="1">ds <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb393-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;ideol&quot;</span>, <span class="st">&quot;cncrn_natres&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb393-3" data-line-number="3"><span class="st">  </span><span class="kw">na.omit</span>() -&gt;<span class="st"> </span>ds.sub</a></code></pre></div>
<p>Reviewing the variables is an important first step:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb394-1" data-line-number="1"><span class="kw">describe</span>(ds.sub<span class="op">$</span>ideol)</a></code></pre></div>
<pre><code>##    vars    n mean   sd median trimmed  mad min max range  skew kurtosis
## X1    1 2508 4.65 1.73      5    4.75 1.48   1   7     6 -0.45     -0.8
##      se
## X1 0.03</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb396-1" data-line-number="1"><span class="kw">describe</span>(ds.sub<span class="op">$</span>cncrn_natres)</a></code></pre></div>
<pre><code>##    vars    n mean   sd median trimmed  mad min max range  skew kurtosis
## X1    1 2508 7.57 2.22      8    7.82 2.97   0  10    10 -0.88     0.38
##      se
## X1 0.04</code></pre>
<p>The ideology variable ranges from 1 “very liberal” to 7 “very conservative.” The <em>cncrn_natres</em> variable measures concern for natural resources ranging from 0 “not concerned” to 10 “extremely concerned.” The dependent and independent variables are defined as:</p>
<p>DV: Ideology<br />
IV: Concern for natural resources</p>
<p>We need to find <span class="math inline">\(\hat{\alpha}\)</span> and <span class="math inline">\(\hat{\beta}\)</span> to develop the estimated bivariate regression model. Our first step is to find <span class="math inline">\(\hat{\beta}\)</span>. Recall the formula for <span class="math inline">\(\hat{\beta}\)</span> is:</p>
<p><span class="math display">\[\hat{\beta}=\frac{cov(x,y)}{var(x)}\]</span></p>
<p>First create <code>x</code> and <code>y</code> variables to make the calculations simpler, with <code>x</code> being the independent variable and <code>y</code> being the dependent variable:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb398-1" data-line-number="1">ds.sub<span class="op">$</span>x &lt;-<span class="st"> </span>ds.sub<span class="op">$</span>ideol</a>
<a class="sourceLine" id="cb398-2" data-line-number="2">ds.sub<span class="op">$</span>y &lt;-<span class="st"> </span>ds.sub<span class="op">$</span>cncrn_natres</a></code></pre></div>
<p>Next we calculate the cov(x,y) for the numerator and var(x) for the denominator:</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" data-line-number="1">r &lt;-<span class="st"> </span><span class="kw">cor</span>(ds.sub<span class="op">$</span>x, ds.sub<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb399-2" data-line-number="2">cov.xy &lt;-<span class="st"> </span><span class="kw">cov</span>(ds.sub<span class="op">$</span>x, ds.sub<span class="op">$</span>y, <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</a>
<a class="sourceLine" id="cb399-3" data-line-number="3">var.x &lt;-<span class="st"> </span><span class="kw">var</span>(ds.sub<span class="op">$</span>x, <span class="dt">na.rm =</span> T)</a></code></pre></div>
<p>Finally, to calculate <span class="math inline">\(\hat{\beta}\)</span>:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb400-1" data-line-number="1">beta.hat &lt;-<span class="st"> </span>cov.xy <span class="op">/</span><span class="st"> </span>var.x</a></code></pre></div>
<p>Now that we have <span class="math inline">\(\hat{\beta}\)</span>, we can calculate <span class="math inline">\(\hat{\alpha}\)</span> Recall the formula for calculating <span class="math inline">\(\hat{\alpha}\)</span>:</p>
<p><span class="math display">\[\hat{\alpha}=\bar{y} - \hat{\beta}\bar{x}\]</span></p>
<p>Calculate <span class="math inline">\(\bar{y}\)</span> and <span class="math inline">\(\bar{x}\)</span> from the sample data:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb401-1" data-line-number="1">ybar &lt;-<span class="st"> </span><span class="kw">mean</span>(ds.sub<span class="op">$</span>y, <span class="dt">na.rm =</span> T)</a>
<a class="sourceLine" id="cb401-2" data-line-number="2">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(ds.sub<span class="op">$</span>x, <span class="dt">na.rm =</span> T)</a></code></pre></div>
<p>Use <span class="math inline">\(\bar{y}\)</span>, <span class="math inline">\(\bar{x}\)</span>, and <span class="math inline">\(\hat{\beta}\)</span> to calculate <span class="math inline">\(\hat{\alpha}\)</span>:</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb402-1" data-line-number="1">alpha.hat &lt;-<span class="st"> </span>ybar <span class="op">-</span><span class="st"> </span>beta.hat <span class="op">*</span><span class="st"> </span>xbar</a></code></pre></div>
<p>Take a look at our calculated <span class="math inline">\(\hat{\alpha}\)</span> and <span class="math inline">\(\hat{\beta}\)</span>:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" data-line-number="1">alpha.hat</a></code></pre></div>
<pre><code>## [1] 8.815973</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb405-1" data-line-number="1">beta.hat</a></code></pre></div>
<pre><code>## [1] -0.2687128</code></pre>
<p>Now create some predicted values of y, concern for natural resources, based on our estimated regression model:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb407-1" data-line-number="1">yhat &lt;-<span class="st"> </span>alpha.hat <span class="op">+</span><span class="st"> </span>beta.hat <span class="op">*</span><span class="st"> </span>ds.sub<span class="op">$</span>x</a>
<a class="sourceLine" id="cb407-2" data-line-number="2"><span class="kw">head</span>(yhat) <span class="co"># Returns the first 5 values</span></a></code></pre></div>
<pre><code>## [1] 7.203696 8.009834 7.203696 7.741122 7.741122 8.278547</code></pre>
<p>To draw inference using the estimated regression model we need to understand how <code>x</code> helps us understand <code>y</code>. More formally, we explore this relationship by evaluating the residuals associated to the coefficients <span class="math inline">\(\hat{\alpha}\)</span> and <span class="math inline">\(\hat{\beta}\)</span>. We are interested in whether the coefficients are statistically different than zero.</p>
<p>-<span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta\)</span> = 0<br />
-<span class="math inline">\(H_1\)</span>: <span class="math inline">\(\beta\)</span> <span class="math inline">\(\neq\)</span> 0</p>
<p>Put simply, if the coefficient <span class="math inline">\(\hat{\beta}\)</span> is zero, than that is to say that no value of x helps us understand y (<span class="math inline">\(0*x=0\)</span>).</p>
<p>If we assume the residuals follow a normal distribution, then we can calculate the t-statistic to examine the coefficient’s statistical significance.</p>
<p>Recall that residuals are the differences in the observed values of the data and the predicted values of the estimated regression model. We can calculate residuals by subtracting the <span class="math inline">\(\hat{y}\)</span> values we just calculated from the <code>y</code> values:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb409-1" data-line-number="1">res &lt;-<span class="st"> </span>ds.sub<span class="op">$</span>y <span class="op">-</span><span class="st"> </span>yhat</a></code></pre></div>
<p>Now that we have the residuals, we need to calculate the residual standard error, which measures the spread of observations around the regression line we just calculated. We also need to know the residual standard error so that we can find the standard errors for the regression coefficients, which are then used to calculate the t scores of the coefficients. To calculate the residual standard error we need to find:</p>
<ol style="list-style-type: decimal">
<li>The residual sum of squares</li>
<li>The degrees of freedom for our model</li>
</ol>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb410-1" data-line-number="1">res.sqr &lt;-<span class="st"> </span>res<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb410-2" data-line-number="2">RSS &lt;-<span class="st"> </span><span class="kw">sum</span>(res.sqr, <span class="dt">na.rm=</span>T)</a></code></pre></div>
<p>Now we need to calculate the degrees of freedom. In this case, we have the intercept and the ideology variable, so we subtract two. Since we subset our data to remove all missing observations, we know the n size for x and y are the same:</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb411-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">length</span>(ds.sub<span class="op">$</span>y) <span class="op">-</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb411-2" data-line-number="2">df</a></code></pre></div>
<pre><code>## [1] 2506</code></pre>
<p>With the residual sum of squares and the degrees of freedom, we have what we need to find the residual standard error:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb413-1" data-line-number="1">RSE &lt;-<span class="st"> </span><span class="kw">sqrt</span>(RSS <span class="op">/</span><span class="st"> </span>df)</a>
<a class="sourceLine" id="cb413-2" data-line-number="2">RSE</a></code></pre></div>
<pre><code>## [1] 2.167453</code></pre>
<p>With the residual standard error, we can now start to calculate the standard errors for our coefficients: <span class="math inline">\(\hat{\alpha}\)</span> and <span class="math inline">\(\hat{\beta}\)</span> (ideology). To calculate these, we need to find the total sum of squares of the independent variable, x:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb415-1" data-line-number="1">TSSx &lt;-<span class="st"> </span><span class="kw">sum</span>((ds.sub<span class="op">$</span>x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb415-2" data-line-number="2">TSSx</a></code></pre></div>
<pre><code>## [1] 7520.929</code></pre>
<p>Now that we have the total sum of squares for the independent variable, we can find the standard errors of our coefficients:</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb417-1" data-line-number="1">SEB &lt;-<span class="st"> </span>RSE <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(TSSx)</a>
<a class="sourceLine" id="cb417-2" data-line-number="2">SEB</a></code></pre></div>
<pre><code>## [1] 0.02499274</code></pre>
<p>For the standard error of <span class="math inline">\(\hat{\alpha}\)</span>, the calculation is different:</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb419-1" data-line-number="1">SEA &lt;-<span class="st"> </span>RSE <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2508</span>)<span class="op">+</span>(xbar<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>TSSx))</a>
<a class="sourceLine" id="cb419-2" data-line-number="2">SEA</a></code></pre></div>
<pre><code>## [1] 0.1240024</code></pre>
<p>With the standard errors calculated, we can now find the corresponding t-statistics:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" data-line-number="1">t.B &lt;-<span class="st"> </span>beta.hat <span class="op">/</span><span class="st"> </span>SEB</a>
<a class="sourceLine" id="cb421-2" data-line-number="2">t.B</a></code></pre></div>
<pre><code>## [1] -10.75163</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" data-line-number="1">t.A &lt;-<span class="st"> </span>alpha.hat <span class="op">/</span><span class="st"> </span>SEA</a>
<a class="sourceLine" id="cb423-2" data-line-number="2">t.A</a></code></pre></div>
<pre><code>## [1] 71.0952</code></pre>
<p>These t-statistics tell us how many standard deviations the coefficients are away from 0.</p>
<div id="calculating-goodness-of-fit" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Calculating Goodness of Fit</h3>
<p>Now we turn to <span class="math inline">\(R^2\)</span>, the measure how well the estimated regression model explains the variability of the data. To find <span class="math inline">\(R^2\)</span>, you need to know:</p>
<ol style="list-style-type: decimal">
<li>The residual sum of squares</li>
<li>The total sum of squares</li>
<li>The explained sum of squares.</li>
</ol>
<p>We already have the residual sum of squares. We found it by taking the sum of the residuals squared. Earlier we calculated the total sum of squares for our independent variable, x, but now we need to find the total sum of squares for our dependent variable, y.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb425-1" data-line-number="1">TSS &lt;-<span class="st"> </span><span class="kw">sum</span>((ds.sub<span class="op">$</span>y <span class="op">-</span><span class="st"> </span>ybar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb425-2" data-line-number="2">TSS</a></code></pre></div>
<pre><code>## [1] 12315.88</code></pre>
<p>Now that we have the residual sum of squares and the total sum of squares, we can find the explained sum of squares. The explained sum of squares tells us how much of the variance of the dependent variable is accounted for by our model.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb427-1" data-line-number="1">ESS &lt;-<span class="st"> </span>TSS <span class="op">-</span><span class="st"> </span>RSS</a>
<a class="sourceLine" id="cb427-2" data-line-number="2">ESS</a></code></pre></div>
<pre><code>## [1] 543.0606</code></pre>
<p><span class="math inline">\(R^2\)</span> is found by dividing the explained sum of squares by the total sum of squares:</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb429-1" data-line-number="1">r.sqr &lt;-<span class="st"> </span>ESS <span class="op">/</span><span class="st"> </span>TSS</a>
<a class="sourceLine" id="cb429-2" data-line-number="2">r.sqr</a></code></pre></div>
<pre><code>## [1] 0.04409434</code></pre>
<p>4% of the variability of the data is explained by the estimated regression model.</p>
<div id="adjusted-r-squared" class="section level4">
<h4><span class="header-section-number">8.1.1.1</span> Adjusted R Squared</h4>
<p>There is a slightly more accurate measure of model fit, though, known as adjusted R squared. Adjusted R squared addresses some problems that are inherent in the R squared calculation, like the realtiy that R squared tends to increase as you add more predictors to your model, even if it’s more due to chance than actual predicting power. Adjusted R squared addresses this issue by penalizing the model for an increased number of predictors. Use this formula to find adjusted R squared</p>
<p><span class="math display">\[1-\frac{(1-R^{2})(n-1)}{n-k-1}\]</span></p>
<p>where k is the number of predictors in our model, not including the intercept(A). We can actually find this pretty simply. Recall that we are working with an n size of 2508. Our k value is 1, becuase we only have one predictor in the model (ideology). Find the adjusted R squared value:</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb431-1" data-line-number="1">adj.r2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>(((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>r.sqr) <span class="op">*</span><span class="st"> </span>(<span class="dv">2508</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2508</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb431-2" data-line-number="2">adj.r2</a></code></pre></div>
<pre><code>## [1] 0.04371289</code></pre>
</div>
</div>
<div id="checking-our-work" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Checking Our Work</h3>
<p>To check our work in the previous steps we will employ the native R functions for linear models: <code>lm()</code>. We provide the observed y and x values from data as an argument, separated by a tilda in the following format:
<code>lm(y ~ x)</code></p>
<p>To demonstrate with the <code>cncrn_natres</code> and <code>ideol</code> variables:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb433-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>(ds.sub<span class="op">$</span>cncrn_natres <span class="op">~</span><span class="st"> </span>ds.sub<span class="op">$</span>ideol)</a></code></pre></div>
<p>Further, the <code>summary()</code> function will provide results of our model, including t-statistics and <span class="math inline">\(R^2\)</span> values:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" data-line-number="1"><span class="kw">summary</span>(model)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ds.sub$cncrn_natres ~ ds.sub$ideol)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.2785 -1.2785  0.3558  1.7215  3.0650 
## 
## Coefficients:
##              Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)   8.81597    0.12400   71.09 &lt;0.0000000000000002 ***
## ds.sub$ideol -0.26871    0.02499  -10.75 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.167 on 2506 degrees of freedom
## Multiple R-squared:  0.04409,    Adjusted R-squared:  0.04371 
## F-statistic: 115.6 on 1 and 2506 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>Let’s compare to our coefficients, residual standard error, coefficient standard errors, t scores, r squared, and adjusted r squared:</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" data-line-number="1">stats &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Beta&quot;</span>, <span class="st">&quot;RSE&quot;</span>, <span class="st">&quot;IntSE&quot;</span>, <span class="st">&quot;BetaSE&quot;</span>, <span class="st">&quot;IntT&quot;</span>,</a>
<a class="sourceLine" id="cb436-2" data-line-number="2">                             <span class="st">&quot;BetaT&quot;</span>, <span class="st">&quot;Rsqr&quot;</span>, <span class="st">&quot;AdjRsqr&quot;</span>),</a>
<a class="sourceLine" id="cb436-3" data-line-number="3">                    <span class="dt">values =</span> <span class="kw">c</span>(alpha.hat, beta.hat, RSE, SEA, SEB, t.A, t.B,</a>
<a class="sourceLine" id="cb436-4" data-line-number="4">                             r.sqr, adj.r2))</a>
<a class="sourceLine" id="cb436-5" data-line-number="5">stats</a></code></pre></div>
<pre><code>##        name       values
## 1 Intercept   8.81597293
## 2      Beta  -0.26871281
## 3       RSE   2.16745310
## 4     IntSE   0.12400237
## 5    BetaSE   0.02499274
## 6      IntT  71.09519785
## 7     BetaT -10.75163278
## 8      Rsqr   0.04409434
## 9   AdjRsqr   0.04371289</code></pre>
</div>
</div>
<div id="bivariate-regression-in-r" class="section level2">
<h2><span class="header-section-number">8.2</span> Bivariate Regression in R</h2>
<p>Suppose you are interested in the relationship between ideology and opinions about how much of Oklahoma’s electricity should come from renewable sources. The class data set includes these variables as <code>ideol</code> and <code>okelec_renew</code>. A new subset data set is created with these variables, absent missing observations, to develop an estimated regression model:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" data-line-number="1">sub.ds &lt;-<span class="st"> </span>ds <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb438-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;okelec_renew&quot;</span>, <span class="st">&quot;ideol&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb438-3" data-line-number="3"><span class="st">  </span><span class="kw">na.omit</span>()</a></code></pre></div>
<p>The <code>okelec_renew</code> variable is new to us, so we should examine its structure:</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" data-line-number="1"><span class="kw">str</span>(sub.ds<span class="op">$</span>okelec_renew)</a></code></pre></div>
<pre><code>##  Factor w/ 63 levels &quot;0&quot;,&quot;1&quot;,&quot;10&quot;,&quot;100&quot;,..: 20 42 32 42 54 42 20 13 53 4 ...</code></pre>
<p>The variable appears to be a factor, which needs to be coerced as a numeric type. Recall the <code>as.numeric()</code> function:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" data-line-number="1">sub.ds <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb441-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">renew =</span> <span class="kw">as.numeric</span>(okelec_renew)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb441-3" data-line-number="3"><span class="st">  </span><span class="kw">drop_na</span>() -&gt;<span class="st"> </span>sub.ds</a></code></pre></div>
<p>Reassess the structure to ensure it is numeric:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" data-line-number="1"><span class="kw">str</span>(sub.ds<span class="op">$</span>renew)</a></code></pre></div>
<pre><code>##  num [1:2524] 20 42 32 42 54 42 20 13 53 4 ...</code></pre>
<p>With the variable now numeric, examine it using the <code>describe()</code> function:</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" data-line-number="1"><span class="kw">describe</span>(sub.ds<span class="op">$</span>renew)</a></code></pre></div>
<pre><code>##    vars    n  mean    sd median trimmed   mad min max range  skew kurtosis
## X1    1 2524 32.56 15.94     34   33.03 20.76   1  63    62 -0.18    -0.96
##      se
## X1 0.32</code></pre>
<p>Before proceeding, we should formalize a hypothesis. Perhaps we hypothesize that conservatives want a lower percentage of renewable energy than liberals. Using renewable energy as a function of ideology, we further specify our hypothesis as a more conservative ideology corresponds to a decrease preference for renewable energy. The null hypothesis is there is no difference in preference among ideologies.</p>
<p>First we examine the normality of both variables. Create a histogram and overlay it with a normal distribution curve, with the correct mean and standard deviation.:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" data-line-number="1"><span class="kw">ggplot</span>(sub.ds, <span class="kw">aes</span>(renew)) <span class="op">+</span></a>
<a class="sourceLine" id="cb446-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span> ..density.. ), <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb446-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sub.ds<span class="op">$</span>renew),</a>
<a class="sourceLine" id="cb446-4" data-line-number="4">                                         <span class="dt">sd =</span> <span class="kw">sd</span>(sub.ds<span class="op">$</span>renew)))</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7br6-1.png" width="672" /></p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" data-line-number="1"><span class="kw">ggplot</span>(sub.ds, <span class="kw">aes</span>(ideol)) <span class="op">+</span></a>
<a class="sourceLine" id="cb447-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb447-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sub.ds<span class="op">$</span>ideol), <span class="dt">sd =</span> <span class="kw">sd</span>(sub.ds<span class="op">$</span>ideol)))</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7br7-1.png" width="672" /></p>
<p>Now construct the model:</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb448-1" data-line-number="1">model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(sub.ds<span class="op">$</span>renew <span class="op">~</span><span class="st"> </span>sub.ds<span class="op">$</span>ideol)</a>
<a class="sourceLine" id="cb448-2" data-line-number="2"><span class="kw">summary</span>(model1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sub.ds$renew ~ sub.ds$ideol)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -38.50 -11.26   2.74  12.74  35.19 
## 
## Coefficients:
##              Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)   43.9430     0.8772   50.10 &lt;0.0000000000000002 ***
## sub.ds$ideol  -2.4472     0.1767  -13.85 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.36 on 2522 degrees of freedom
## Multiple R-squared:  0.07069,    Adjusted R-squared:  0.07032 
## F-statistic: 191.8 on 1 and 2522 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>Based on the results, ideology helps us understand preference for renewable energy. Further examination of the coefficient for <code>ideol</code> yields an estimate value of -2.45. This is interpreted as a -2.45 unit decrease in renewable energy preference for each unit increase in ideology. That is, an increase on the ideology scale (1 “liberal” to 7 “conservative”) results in a reduction in preference for renewable energy.</p>
<p>We should always visualize a relationship that we’re trying to convey. Start by constructing a scatter plot and adding a regression line:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" data-line-number="1"><span class="kw">ggplot</span>(sub.ds, <span class="kw">aes</span>(<span class="dt">x =</span> ideol, <span class="dt">y =</span> renew)) <span class="op">+</span></a>
<a class="sourceLine" id="cb450-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb450-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm) <span class="op">+</span></a>
<a class="sourceLine" id="cb450-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">shape =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7br9-1.png" width="672" /></p>
<p>Sometimes it is more beneficial when visualizing the relationship to plot the regression line without first showing the scatter plot. To do this with ggplot2, simply do not include the <code>geom_point()</code> or <code>geom_jitter()</code> functions in the visualization.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" data-line-number="1"><span class="kw">ggplot</span>(sub.ds, <span class="kw">aes</span>(<span class="dt">x =</span> ideol, <span class="dt">y =</span> renew)) <span class="op">+</span></a>
<a class="sourceLine" id="cb451-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm) </a></code></pre></div>
<p><img src="_main_files/figure-html/7_7br10-1.png" width="672" /></p>
</div>
<div id="the-residuals" class="section level2">
<h2><span class="header-section-number">8.3</span> The Residuals</h2>
<p>Recall that when using Ordinary Least Squares regression, there are three assumptions made about the error terms:</p>
<ol style="list-style-type: decimal">
<li>Errors have identical distributions</li>
<li>Errors are independent of X and other error terms</li>
<li>Errors are normally distributed</li>
</ol>
<p>To look at the residual values for the estimated regression model, use the <code>names()</code> function:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" data-line-number="1"><span class="kw">names</span>(model)</a></code></pre></div>
<pre><code>##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         
##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  
##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</code></pre>
<p>In R we can examine the distribution of the residuals relatively simply. First assign the residuals to an object:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" data-line-number="1">resid &lt;-<span class="st"> </span>model<span class="op">$</span>residuals</a></code></pre></div>
<p>Now plot a histogram of the residuals, adding a normal density curve with the mean and standard deviation of our residuals:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" data-line-number="1"><span class="kw">ggplot</span>(model, <span class="kw">aes</span>(model<span class="op">$</span>residuals)) <span class="op">+</span></a>
<a class="sourceLine" id="cb455-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span>  ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb455-3" data-line-number="3"><span class="st">   </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(model<span class="op">$</span>residuals), <span class="dt">sd =</span> <span class="kw">sd</span>(model<span class="op">$</span>residuals)))</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/7_7res3-1.png" width="672" /></p>
<p>We also look at a QQ plot of the residuals:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" data-line-number="1"><span class="kw">ggplot</span>(model, <span class="kw">aes</span>(<span class="dt">sample =</span> model<span class="op">$</span>residuals)) <span class="op">+</span></a>
<a class="sourceLine" id="cb457-2" data-line-number="2"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb457-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7res4-1.png" width="672" /></p>
</div>
<div id="comparing-models" class="section level2">
<h2><span class="header-section-number">8.4</span> Comparing Models</h2>
<p>Suppose you wanted to create multiple bivariate models and contrast them. This is possible using the <code>mtable()</code> function from the <code>memisc</code> package. To demonstrate, we create three models looking at the relationship between an independent variable and concern about global climate change. The three independent variables will be ideology, certainty that humans cause climate change, and age. We start by creating a subset of our data and removing missing observations:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" data-line-number="1">sub &lt;-<span class="st"> </span>ds <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb458-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;glbcc_risk&quot;</span>, <span class="st">&quot;glbcc_cert&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;ideol&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb458-3" data-line-number="3"><span class="st">  </span><span class="kw">na.omit</span>() </a>
<a class="sourceLine" id="cb458-4" data-line-number="4">model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(sub<span class="op">$</span>glbcc_risk <span class="op">~</span><span class="st"> </span>sub<span class="op">$</span>ideol)</a>
<a class="sourceLine" id="cb458-5" data-line-number="5">model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(sub<span class="op">$</span>glbcc_risk <span class="op">~</span><span class="st"> </span>sub<span class="op">$</span>glbcc_cert)</a>
<a class="sourceLine" id="cb458-6" data-line-number="6">model3 &lt;-<span class="st"> </span><span class="kw">lm</span>(sub<span class="op">$</span>glbcc_risk <span class="op">~</span><span class="st"> </span>sub<span class="op">$</span>age)</a></code></pre></div>
<p>Using the <code>mtable()</code> function, we can create regression tables that compare all three of the models:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" data-line-number="1"><span class="kw">mtable</span>(model1, model2, model3)</a></code></pre></div>
<pre><code>## 
## Calls:
## model1: lm(formula = sub$glbcc_risk ~ sub$ideol)
## model2: lm(formula = sub$glbcc_risk ~ sub$glbcc_cert)
## model3: lm(formula = sub$glbcc_risk ~ sub$age)
## 
## =========================================================
##                     model1       model2       model3     
## ---------------------------------------------------------
##   (Intercept)       10.821***     3.171***     6.927***  
##                     (0.142)      (0.150)      (0.267)    
##   sub$ideol         -1.048***                            
##                     (0.029)                              
##   sub$glbcc_cert                  0.419***               
##                                  (0.021)                 
##   sub$age                                     -0.016***  
##                                               (0.004)    
## ---------------------------------------------------------
##   R-squared          0.349        0.137        0.006     
##   N               2508         2508         2508         
## =========================================================
##   Significance: *** = p &lt; 0.001; ** = p &lt; 0.01;   
##                 * = p &lt; 0.05</code></pre>
<p>Alternatively, you can use the <code>stargazer()</code> function to create tables for your models. The <code>stargazer()</code> function is different in that you can specify a table created with text or with LaTex code that you can subsequently paste into a LaTex document. We’ll create a text table, but if you wanted to create a Latex table, you would use the <code>type=latex</code> argument.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb461-1" data-line-number="1"><span class="kw">stargazer</span>(model1, model2, model3, <span class="dt">type=</span><span class="st">&quot;text&quot;</span>, <span class="dt">style=</span><span class="st">&quot;apsr&quot;</span>)</a></code></pre></div>
<pre><code>## 
## -----------------------------------------------------------------
##                                            glbcc_risk            
##                                     (1)         (2)        (3)   
## -----------------------------------------------------------------
## ideol                            -1.048***                       
##                                   (0.029)                        
## glbcc_cert                                    0.419***           
##                                               (0.021)            
## age                                                     -0.016***
##                                                          (0.004) 
## Constant                         10.821***    3.171***  6.927*** 
##                                   (0.142)     (0.150)    (0.267) 
## N                                  2,508       2,508      2,508  
## R2                                 0.349       0.137      0.006  
## Adjusted R2                        0.349       0.137      0.005  
## Residual Std. Error (df = 2506)    2.479       2.854      3.064  
## F Statistic (df = 1; 2506)      1,344.256*** 397.859*** 14.232***
## -----------------------------------------------------------------
## *p &lt; .1; **p &lt; .05; ***p &lt; .01</code></pre>
<div id="visualizing-multiple-models" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Visualizing Multiple Models</h3>
<p>The three models can be visualized together by melting the data set into long form, with the three IVs as measure variables, then using <code>ggplot2</code> and facet wrapping by independent variable. Including <code>scales = &quot;free_x&quot;</code> inside the <code>facet_wrap()</code> function will make the visualization so that each plot has its own independent x axis but is on the same fixed y axis.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb463-1" data-line-number="1"><span class="kw">melt</span>(sub, <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;ideol&quot;</span>, <span class="st">&quot;glbcc_cert&quot;</span>, <span class="st">&quot;age&quot;</span>),</a>
<a class="sourceLine" id="cb463-2" data-line-number="2">              <span class="dt">variable.name =</span> <span class="kw">c</span>(<span class="st">&quot;IV&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb463-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(value, glbcc_risk)) <span class="op">+</span></a>
<a class="sourceLine" id="cb463-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm) <span class="op">+</span></a>
<a class="sourceLine" id="cb463-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>IV, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7vis-1.png" width="672" /></p>
</div>
</div>
<div id="hypothesis-testing" class="section level2">
<h2><span class="header-section-number">8.5</span> Hypothesis Testing</h2>
<p>Let’s do one more example of how we would hypothesis test with bivariate regression. In the class data set there is a variable, <code>wtr_comm</code>, that asks the respondent if they think the supplies of water in their region will be adequate to meet their community’s needs over the next 25 years. In essence, this measures concern about water supply for the community.</p>
<p>Start with a research question: What is the relationship between concern for water supply and concern about climate change?</p>
<p>Now build a theory: We could reasonably theorize that individuals who are more concerned about water supply are also likely more concerned about climate change. There is likely a link in their head between climate change and a shortened water supply.</p>
<p>Built on this theory, we can specify a hypothesis that individuals more concerned about climate change will be more concerned about water supply for their community. The null hypothesis is that there is no relationship between climate change concern and water concern.</p>
<p>We create a subset of the dataset that includes out two variables and remove missing observations:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" data-line-number="1">new.ds &lt;-<span class="st"> </span>ds <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb464-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;wtr_comm&quot;</span>, <span class="st">&quot;glbcc_risk&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb464-3" data-line-number="3"><span class="st">  </span><span class="kw">na.omit</span>()</a></code></pre></div>
<p>Now examine the variables:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb465-1" data-line-number="1"><span class="kw">describe</span>(new.ds<span class="op">$</span>wtr_comm)</a></code></pre></div>
<pre><code>##    vars    n mean   sd median trimmed  mad min max range  skew kurtosis
## X1    1 2524 3.21 1.03      3    3.24 1.48   1   5     4 -0.34    -0.68
##      se
## X1 0.02</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb467-1" data-line-number="1"><span class="kw">describe</span>(new.ds<span class="op">$</span>glbcc_risk)</a></code></pre></div>
<pre><code>##    vars    n mean   sd median trimmed  mad min max range  skew kurtosis
## X1    1 2524 5.95 3.07      6    6.14 2.97   0  10    10 -0.32    -0.93
##      se
## X1 0.06</code></pre>
<p>Note that the climate change risk variable goes from 0 to 10 and the water supply concern variable ranges from 1 to 5, with 1 being definitely no (the supplies of water are NOT enough) and 5 being definitely yes.</p>
<p>Now visualize the normality of the variables:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" data-line-number="1"><span class="kw">ggplot</span>(new.ds, <span class="kw">aes</span>(wtr_comm)) <span class="op">+</span></a>
<a class="sourceLine" id="cb469-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb469-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(new.ds<span class="op">$</span>wtr_comm), <span class="dt">sd =</span> <span class="kw">sd</span>(new.ds<span class="op">$</span>wtr_comm)), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7hyp4-1.png" width="672" /></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb470-1" data-line-number="1"><span class="kw">ggplot</span>(new.ds, <span class="kw">aes</span>(glbcc_risk)) <span class="op">+</span></a>
<a class="sourceLine" id="cb470-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb470-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(new.ds<span class="op">$</span>glbcc_risk), <span class="dt">sd =</span> <span class="kw">sd</span>(new.ds<span class="op">$</span>glbcc_risk)), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7hyp5-1.png" width="672" /></p>
<p>Next, create the model. Recall that the dependent variable is concern for water supply and the independent variable is climate change risk.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb471-1" data-line-number="1">lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(new.ds<span class="op">$</span>wtr_comm <span class="op">~</span><span class="st"> </span>new.ds<span class="op">$</span>glbcc_risk)</a></code></pre></div>
<p>Now examine and interpret the results:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb472-1" data-line-number="1"><span class="kw">summary</span>(lm1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = new.ds$wtr_comm ~ new.ds$glbcc_risk)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7366 -0.8442  0.1557  0.7096  2.1557 
## 
## Coefficients:
##                    Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)        3.736575   0.042974   86.95 &lt;0.0000000000000002 ***
## new.ds$glbcc_risk -0.089233   0.006423  -13.89 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.99 on 2522 degrees of freedom
## Multiple R-squared:  0.07109,    Adjusted R-squared:  0.07072 
## F-statistic:   193 on 1 and 2522 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>The independent variable coefficient is about -.09, with a corresponding p-value <span class="math inline">\(\approx\)</span> 0. This is interpreted as a one unit change in climate change risk corresponds with a -0.09 unit change in water supply concern. Remember that the water supply variable goes from 1 (there is definitely not enough water) to 5 (there definitely is enough water). These findings suggest that an individual more concerned about climate change is also more concerned about water supply.</p>
<p>We examine the normality of the residuals:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb474-1" data-line-number="1"><span class="kw">ggplot</span>(lm1, <span class="kw">aes</span>(lm1<span class="op">$</span>residuals)) <span class="op">+</span></a>
<a class="sourceLine" id="cb474-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb474-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(lm1<span class="op">$</span>residuals), <span class="dt">sd =</span> <span class="kw">sd</span>(lm1<span class="op">$</span>residuals)), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7hyp8-1.png" width="672" /></p>
<p>Now build a good visualization that would be worthy of a paper:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" data-line-number="1"><span class="kw">ggplot</span>(new.ds, <span class="kw">aes</span>(wtr_comm, glbcc_risk)) <span class="op">+</span></a>
<a class="sourceLine" id="cb475-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm) <span class="op">+</span></a>
<a class="sourceLine" id="cb475-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">9</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb475-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Concern for Water and Climate Change&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb475-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Considers Water Supply Adequate&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb475-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Perceived Climate Change Risk&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb475-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span> ,<span class="dv">3</span> ,<span class="dv">4</span> ,<span class="dv">5</span>), <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Definitely No&quot;</span>, </a>
<a class="sourceLine" id="cb475-8" data-line-number="8">                                                       <span class="st">&quot;Probably No&quot;</span>, <span class="st">&quot;Unsure&quot;</span>,</a>
<a class="sourceLine" id="cb475-9" data-line-number="9">                                                       <span class="st">&quot;Probably Yes&quot;</span>, <span class="st">&quot;Definitely Yes&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb475-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/7_7hyp9-1.png" width="672" /></p>
<p>Our findings support that individuals less concerned about climate change are also less concerned about their community’s water supply.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="covariance-and-correlation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariable-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
